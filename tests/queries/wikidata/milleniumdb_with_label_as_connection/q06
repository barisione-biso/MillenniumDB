// Original: US states ordered by number of neighbouring state
// Modified: GROUP BY and Nested query not supported
// US states and their neighbours
SELECT ?state, ?neigh, ?state_label.string_value, ?neigh_label.string_value
MATCH (?state)-[:P31]->(Q35657),
      (?neigh)-[:P47]->(?state),
      (?neigh)-[:P31]->(?Q35657)
OPTIONAL {
      (?state)-[:Label {language:"en"}]->(?state_label),
      (?neigh)-[:Label {language:"en"}]->(?neigh_label)
}
LIMIT 100